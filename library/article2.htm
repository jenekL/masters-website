<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Оценки качества для анализа цифровых изображений</title>
    <link rel="stylesheet" type="text/css" href="../css/files/articles.css">
</head>
<body>

<div id="topblock">
    <a href="index.htm">Назад в библиотеку</a>
    <br>
    <hr>
</div>

<p><b>Источник:</b>
    Государственное научное учреждение «Объединенный институт проблем информатики Национальной академии наук Беларуси» (ОИПИ НАН Беларуси), г. Минск, Беларусь</p>

<h1 style="text-align: center">Оценки качества для анализа цифровых изображений</h1>
<p ><b>Авторы:</b> Ю.И. Монич, В.В. Старовойтов<br></p>
<p >Государственное научное учреждение &laquo;Объединенный институт проблем информатики Национальной
    академии наук Беларуси&raquo; (ОИПИ НАН Беларуси), г. Минск, Беларусь</p>    <br>
<div>
    <h3>Аннотация</h3>
    <p ><i> В статье дана классификация оценок качества изображений.
        Возможны два подхода к оценке качества изображений: количественная оценка с помощью использования математических
        методов и субъективная оценка на основе экспертных оценок. С другой стороны, субъективные и количественные
        оценки качества изображений могут быть абсолютными или сравнительными. В статье представлены наиболее
        распространенные оценки качества изображения, дана их классификация. Приведены рейтинговые шкалы для
        субъективной оценки качества изображений.</i></p>

    <h3>Введение</h3>
    <p>Качество цифрового изображения зависит от условий освещения, а также от характеристик регистрирующей системы:
        соотношения сигнал/шум, статистических характеристик шума, градационных характеристик, интервалов дискретизации
        спектральных (цветовых) характеристик и т.д. Оценка качества изображения является достаточно сложной комплексной
        задачей.</p>
    <h3>1. Классификация оценок качества изображений</h3>
    <p>Возможны два подхода к оценке качества изображений: количественная оценка с помощью использования математических
        методов (среднеквадратическая ошибка, Lp-норма [1-4], меры, учитывающие особенности восприятия изображения
        зрительной системой человека) и субъективная оценка на основе экспертных оценок.
    </p>

        <img src="images/2/1.png" alt="Рисунок 1" class="center">
        <p class="caption">Рисунок 1 &#8212; Классификация оценок качества изображения</p>

    <p>С другой стороны, субъективные и количественные оценки качества изображений могут быть абсолютными или
        сравнительными. Абсолютная мера качества используется для оценки одного изображения, т.е. изображению
        присваивается соответствующая категория в рейтинговой шкале. Сравнительные меры используются для ранжирования
        набора изображений в качественной шкале от &laquo;лучше всего&raquo; до &laquo;хуже всего&raquo; или взаимного сравнения двух
        изображений, например, исходного и отфильтрованного (или полученного в разные дни, разными камерами и т.д.). На
        рис. 1 представлена классификация оценок качества изображений. Подробнее оценки рассматриваются в следующих
        разделах.</p>

    <h3>2. Субъективные оценки качества изображений</h3>
    <p>Субъективная оценка качества изображения зависит от различных внешних факторов, например, условий окружающей
        среды, освещения, настроения специалиста, который производит оценку, качества монитора, характера
        рассматриваемых изображе- ний и др. Существует два вида экспертных оценок: абсолютные и сравнительные [5].</p>
    <p>В табл. 1 приведены примеры рейтинговых шкал, использованных для субъективной оценки качества изображений [4],
        [6].</p>
    <p>Таблица 1 &#8212; Рейтинговые шкалы для субъективной оценки качества изображений</p>

        <img src="images/2/2.png" alt="Рисунок 2" class="center">

    <p>Зрительная система человека &#8212; наиболее надежный и совершенный измери- тельный инструмент, оценивающий качество
        цифрового изображения. Однако субъективная оценка &#8212; это довольно затруднительный и медленный процесс, который
        требует опытных экспертов и не является объективным и универсальным.</p>
    <p>Для решения задачи оценки качества изображения в общем виде нужно найти количественные оценки, которые наилучшим
        образом соответствуют субъективным. Такие оценки можно получить в несколько этапов:
    </p>
    <ul>
        <li>подготавливается представительный набор изображений, на котором выполняются оценки качества;</li>
        <li>осуществляется количественный анализ качества изображения различными методами, в результате чего получают
            оценки качества изображения для каждого метода оценивания;
        </li>
        <li>выполняется субъективный анализ принятого изображения наблюдателями-экспертами, которым демонстрируются
            изображения. Оценки разных экспертов для одного и того же изображения усредняются;
        </li>
        <li>сравниваются оценки изображений, полученные количественными и субъектив- ными методами и выясняется, какой
            из количественных методов наиболее точно характеризует качество изображения.
        </li>
    </ul>
    <p></p>
    <p>Для того чтобы количественные оценки качества изображения лучше соответствовали субъективным, следует учитывать
        особенности человеческого восприятия изображения, например [7]:
    </p>
    <ul>
        <li>цветовое разрешение человеческого зрения ниже яркостного;</li>
        <li>человек маловосприимчив к мелким цветным деталям.</li>
    </ul>
    <p></p>

    <h3>3. Количественные оценки качества изображений</h3>
    <p>Количественные меры качества изображения также, как и субъективные, можно разделить на две группы: абсолютные и
        сравнительные. Абсолютная мера представляет собой число, сопоставляемое любому изображению на основе анализа
        этого изображения. Сравнительная мера является числовым результатом сравнения двух или более изображений [3].
        Для сравнения также можно использовать абсолютные меры, вычисленные для каждого изображения по отдельности.</p>
    <h3>3.1. Абсолютные оценки</h3>
    <h3>3.1.1. Оценка резкости изображения</h3>
    <p>Резкость изображения &#8212; один из важнейших показателей его качества, во многом определяющий пригодность изображения
        к дальнейшей обработке. Резкость изображения &#8212; это степень размытости границы между двумя соседними участками
        изображения с разной оптической плотностью (яркостью). На рис. 2а) представлено резкое изображение, на рис. 2б)
        &#8212; тоже изображение, но размытое. Авторы [8] предлагают определять меру резкости изображения S путем нахождения
        угла наклона профиля яркости изображения на границе перепада (рис. 2д)).</p>

        <img src="images/2/3.png" alt="Рисунок 3" class="center">

    <p>где i &#8212; количество краевых пикселей на изображении, w &#8212; это ширина перепада, G &#8212; это разница между значениями
        яркостей пикселей, обозначенных a и b (рис. 2д)).</p>

        <img src="images/2/4.png" alt="Рисунок 4" class="center">


        <img src="images/2/5.png" alt="Рисунок 2" class="center">
        <p class="caption">Рисунок 2 &#8212; а) исходное изображение; б) размытое изображение;
            в), г) профили яркостей изображений а) и б); д) схема вычисления угла наклона</p>


    <p>Предложенный алгоритм включает следующие шаги.</p>
    <ol>
        <ol>1. Выделить краевые пиксели, используя детектор краев.</ol>
        <ol>2. В цикле, для каждого краевого пикселя, определить направление градиента.</ol>
        <ol>3. В цикле, для каждого краевого пикселя, вдоль направления градиента найти ближайшие пиксели с минимальным
            a и максимальным b значениями яркостей и расстояние между ними w (рис. 2д)).
        </ol>
        <ol>4. Вычислить меру резкости для каждого краевого пикселя Si, подставив w, a и b в (2).</ol>
        <ol>5. Максимальное значение из всех полученных является мерой резкости изображения S: S = max{Si}.</ol>
    </ol>

        <img src="images/2/6.png" alt="Рисунок 3" class="center">
        <p class="caption">Рисунок 3 &#8212; Изображения, размытые усредняющим фильтром радиуса R и их
            количественная оценка резкости S</p>

    <p>Примеры вычисления предложенной оценки резкости изображений представ- лены на рис. 3 &#8212; 4. Использовалось 2 типа
        размытия исходных изображений: усреднение (по окружности радиуса R) и размытие в горизонтальном направлении на D
        пикселей. В экспериментах использовались полутоновые изображения. Для оценки резкости цветных изображений они
        преобразуются в одно из цветовых пространств YСbСr, HSV, HSL и мера S вычисляется только для компоненты
        яркости.</p>

        <img src="images/2/7.png" alt="Рисунок 4" class="center">
        <p class="caption">Рисунок 4 &#8212; Изображения с разной степенью горизонтального размытия на D пикселей и
            их количественная оценка резкости S</p>


    <h3>3.1.2. Оценка контраста изображения</h3>
    <p>Еще одним параметром, который определяет качество изображений, является контраст. Контраст &#8212; это градационная
        характеристика черно-белого или цветного изображения по различию в светлоте (насыщенности цвета) его наиболее
        ярких и наиболее темных участков.</p>
    <p>Поскольку изображение имеет сложный сюжетный характер, то это порождает необходимость при определении его
        контрастности выходить из контраста отдельных комбинаций элементов изображения [9]. При этом все элементы
        считаются равно- значными, и контраст каждой их пары вычисляется по формуле (3). Пиксели для сравнения можно
        выбирать различными способами. Наиболее простой способ &#8212; сравнение соседних пикселей в горизонтальном и
        вертикальном направлении.</p>
 
        <img src="images/2/8.png" alt="pic8" class="center">

    <p>где Li , Lj &#8212; яркости элементов изображения. Далее, применяя правило суммирования контрастов, вычисляют набор
        величин, которые определяют восприятие каждой пары элементов изображения. Проводя усреднение матрицы локальных
        контрастов, получают суммарный контраст. Полученный результат может быть использован как один из параметров
        оценки визуального качества изображения.</p>
    <p>Существует еще один метод оценки качества изображения. Его суть состоит в следующем. Экспериментально было
        установлено, что оптимальное, с точки зрения субъективного восприятия, изображение имеет нормальное
        распределение яркостей его элементов. Для удобства дальнейших расчетов был применен критерий нормального
        распределения. По степени отклонения реального распределения яркостей от нормального проводилась оценка качества
        изображения. Кроме количественной оценки качества изображения, данный метод позволяет получить информацию о на-
        личии и весовом соотношении яркостных градаций изображения. Результаты оценки качества изображения, полученные
        по данному методу, хорошо коррелируют с субъективной оценкой визуального качества изображения [9].</p>
    <p>Если в (1) вместо G подставить (3), получится комбинированная оценка резкости и яркости изображения.</p>
    <p>Определение абсолютной количественной оценки качества изображения &#8212; это очень сложная, трудоемкая и до сих пор не
        решенная до конца задача. На практике чаще всего используют сравнительные количественные меры качества
        изображений.</p>

    <h3>3.2. Сравнительные оценки двух изображений</h3>
    <h3>3.2.1. Среднеквадратическая ошибка, пиковое отношение сигнал-шум</h3>
    <p>Наиболее часто используемые сравнительные оценки качества двух изображений &#8212; это среднеквадратическая ошибка
        (СКО) и пиковое отношение сигнал-шум (ПСКО). Методы, основанные на этих оценках, хороши для изображений, имеющих
        белый шум. Однако эти меры некорректно отражают структурные искажения при кодировании (сжатии) изображения, а
        также плохо коррелируют с визуальной оценкой качества [10]. На рис. 5 приведены примеры изображений и их
        значения средне- квадратической ошибки и пикового отношения сигнала/шум.</p>

        <img src="images/2/9.png" alt="Рисунок 5" class="center">
        <p class="caption">Рисунок 5 &#8212; Оценка качества изображения &laquo;Эйнштейн&raquo; с разным типом шума а) исходное
            изображение; б) искаженное изображение: СКО = 14,5,
            ПСКО = 24,9 dB; в) искаженное изображение: СКО = 15,5, ПСКО = 24,3 dB. Оба искаженных изображения имеют
            приблизительно одинаковые значения среднеквадратической ошибки и пикового отношения сигнала/шум</p>

    <p>Уайлдер [11] провел глубокое исследование свойств абсолютной и среднеквадратической ошибок в дискретной форме
        применительно к степенному, логарифмическому и градиентному преобразованиям, а также к преобразованию Лапласа.
        Было выяснено, что поэлементные преобразования в сочетании с критериями абсолютной и среднеквадратической ошибок
        не позволяют получить меру качества изображения, согласующегося с субъективными оценками.</p>
    <h3>3.2.2. Оценка резкости изображений</h3>
    <p>Одной из количественных сравнительных оценок качества изображения может служить резкость. В предложенном
        алгоритме резкость измерялась путем вычисления меры эксцесса двумерного спектра Фурье.<br>
        <b>Алгоритм определения резкости изображения</b>
    </p>
    <ul>
        <ol>1. Выделить прямоугольную область на изображении.</ol>
        <ol>2. Выделенную область интереса преобразовать в частотную область.</ol>
        <ol>3. Вычислить меру эксцесса двумерного спектра Фурье полученной области.</ol>
    </ul>
    <p>Эксцесс определяется как отношение четвертого центрального момента и квадрата второго центрального момента
        (стандартное отклонение в четвертой степени) (4).</p>
    <div class="img">
        <img src="images/2/10.png" alt="pic10">
    </div>
    <p>где &#956;<sub>2</sub> &#8212; второй центральный момент, &#956;<sub>4</sub> &#8212; четвертый центральный момент, &#963; &#8212;
        стандартное отклонение.
    </p>
    <ul>
        <ol>Конец алгоритма.</ol>
    </ul>

        <img src="images/2/11.png" alt="Рисунок 6" class="center">
        <p class="caption">Рисунок 6 &#8212; а, д, и &#8212; исходные изображения областей РОГ (100x100 пикселей); б, е, к
            &#8212; Фурье спектры исходных изображений; в, ж, л &#8212; Размытое изображение (ф.Гаусса R=10, &#963;=25); г, з, м &#8212;
            Фурье спектр размытого изображения</p>

    <p>В экспериментах использовались изображения радужной оболочки глаза (РОГ). Были вырезаны прямоугольные области
        (100x100 пикселей). Сравнивались мера эксцесса спектра Фурье исходного изображения и мера эксцесса спектра Фурье
        изображения, обработанного фильтром Гаусса. Результаты оценки резкости изображений РОГ приведены на рис. 6.</p>
    <p>Так как высоких пространственных частот на резком изображении больше, чем на размытом, следовательно, двумерное
        распределение спектра Фурье для резкого изображения будет шире. Более резкому изображению радужки соответствует
        большая величина эксцесса.</p>

    <h3>3.2.3. Норма Минковского</h3>
    <p>Эта мера оценивает разницу между двумя изображениями X = {x<sub>ij</sub>} и Y = {y<sub>ij</sub>}.</p>

        <img src="images/2/12.png" alt="pic12" class="center">

    <p>где L<sub>p</sub> &#8212; значение нормы Минковского. Значение при сравнении идентичных изображений равно нулю [12].
        Норма Минковского не учитывает структурного подобия изображений. Пример приведен на рис. 7, где два тестовых
        сигнала сгенерированы из исходного изображения. Структурная информация исходного изображения практически
        полностью потеряна во втором тестовом примере, но сохранена в первом. Чтобы вычислить норму Минковского, сначала
        вычитаем исходный сигнал из тестовых сигналов, получая ошибочные сигналы 1 и 2, у которых совсем разная
        структура. Однако применение абсолютного оператора к полученным результатам дает одинаковую абсолютную ошибку.
        И, как следствие, одинаковые значения норм Минковского, даже при различных значениях параметра <em>p</em>.
        Пример демонстрирует, что норма Минковского не всегда соответствует визуальной оценке сходства изображений,
        имеющих одинаковое значение нормы. А также показывает, что структурная информация изображения играет важную роль
        в методах оценки качества изображений.</p>

        <img src="images/2/13.png" alt="pic13" class="center">
        <p class="caption">Рисунок 7 &#8212; Одинаковые нормы Минковского для разных пар изображений</p>


    <h3>3.2.4. Мера структурного подобия</h3>
    <p>Мера структурного подобия была предложена Вангом в работе [13] для сравне- ния полутоновых изображений. Значение
        меры структурного подобия вычисляется по формулам:</p>

        <img src="images/2/14.png" alt="pic14" class="center">

    <p>где SSIM &#8212; значение меры сходства (качества) изображений; X = {x<sub>ij</sub>} и Y = {y<sub>ij</sub>} &#8212;
        сравниваемые изображения; <em>M</em>, <em>N</em> &#8212; размеры изображения. Первая составляющая выражения (6)
        является коэффициентом корреляции между изображениями <em>X</em> и <em>Y</em>. Вторая составляющая характеризует
        сходство средних значений яркостей двух сравниваемых изображений. Третья составляющая характеризует сходство
        контрастов двух сравниваемых изображений.</p>


        <img src="images/2/15.png" alt="Рисунок 8" class="center">
        <p class="caption">Рисунок 8 &#8212; Оценка качества изображений при помощи меры структурного подобия SSIM:
            а) &#8212; исходное изображение со спутника 285x185 пикселей;
            б) &#8212; изображение, обработанное фильтром Гаусса с параметрами: &#963; = 5, R = 15; в) &#8212; изображение,
            обработанное фильтром Гаусса с параметрами: &#963; = 15, R = 30</p>

    <p>Чем выше значение меры сходства изображений, тем лучше выполнена обработка изображения. В общем случае мера
        сходства изображений рассчитывается в непересекающихся областях для каждого изображения отдельно. Поскольку на
        изображениях сцены объекты не изменялись и не двигались, меру можно вычислять сразу на всем изображении.
        Результаты экспериментов представлены на рис. 8 &#8212; 9.</p>

        <img src="images/2/16.png" alt="Рисунок 9" class="center">
        <p class="caption">Рисунок 9 &#8212; Сравнения качества изображений при помощи меры структурного подобия
            SSIM: а) &#8212; исходное изображение со спутника 500x500 пикселей;
            б) &#8212; изображение, обработанное фильтром Кувахара с маской 3х3; в) &#8212; изображение, обработанное фильтром
            Кувахара с маской 5х5</p>


    <h3>Заключение</h3>
    <p>Очевидно, что количественные меры качества изображения необходимы для проектирования и оценки систем
        воспроизведения изображений. Эти меры во многом помогут избавиться от трудоемкой и неточной современной методики
        оценки изображений посредством субъективной экспертизы. Кроме того, на основе количественных мер можно развивать
        методы оптимизации систем обработки изображений.</p>
    <p>В разработке количественных оценок качества изображения достигнуты значи- тельные успехи. Однако введенные
        критерии не являются достаточно совершенными. Большинство попыток найти приемлемые оценки качества изображения
        относится к частным случаям. Предлагается некая оценка, основанная на каких-либо физиологи- ческих предпосылках,
        а чаще просто удобная для анализа и вычислений, а затем оце- ниваются его свойства. Создание более совершенных
        оценок качества изображений связано с более глубоким изучением свойств зрительной системы человека.
    </p>

    <p><b>Перечень источников</b></p>
    <p >
        <ol>
        <li> Jain A.K. Fundamentals of Digital Image Processing. &#8212; Prentice-Hall, Inc., USA, 1989.<br>
    <li>Limb J.O. Distortion Criteria of the Human Viewer. IEEE Transactions on Systems // Man and Cybernetics. &#8212;
        December 1979. &#8212; Vol. 9, № 12. &#8212; Р. 778-793.<br>
    <li>Pratt W.K. Digital Image Processing. &#8212; John Wiley and Sons, Inc., USA, 1978.<br>
    <li>Snyder H.L. Image quality: Measures and visual performance // Flat-Panel Displays and CRTs. &#8212; Tannas L.E.,
        Jr. Ed. &#8212; New York: Van Nostrand Reinhold, 1985. &#8212; Р. 70-90.<br>
    <li>Shnayderman A., Gusev A., Eskicioglu A.M. An SVD-Based Gray-Scale Image Quality Measure for Local and Global
        Assessment // IEEE Transactionson image processing. &#8212; February 2006. &#8212; Vol. 15, №. 2.<br>
    <li>Netravali A.N. and Limb J.O. Picture Coding: A Review // Proceedings of the IEEE. &#8212; March 1980. &#8212; Vol. 68, №
        3. &#8212; Р. 366-406.<br>
    <li>Гугель Ю.В., Гуров В.С., Гуров И.П., Семенов Н.В., Шалаев М.А. Оценка качества передачи динамических
        изображений в формате mpeg по реальным каналам связи // VII Всероссийская научно-методическая конференция
        &laquo;Телематика'2000&raquo;.<br>
    <li>Wang X., Tian B., Liang C., Shi D. Blind Image Quality Assessment for Measuring Image Blur // Congress on
        Image and Signal 2008 Congress on Image and Signal Processing, 2008.<br>
    <li>Журавель И.М. Краткий курс теории обработки изображений.
    <li>Avcibas I., Sankur B., Sayood K. Statistical evaluating of image quality measures // Journal of Electronic
        Imaging. &#8212; April 2002. &#8212; Vol.11, № 2. &#8212; Р. 206-223.<br>
    <li>Wilder W.C. Subjective Relevant Error Criteria for Pictorial Data Processing // Purdue University, School of
        Electrical Engineering, Report TR-EE 72-34, December 1972.<br>
    <li>Макаров А.О. Алгоритмы увеличения пространственного разрешения и обработки мультиспект- ральных спутниковых
        изображений: Дис… к-та техн. наук: 05.13.01/ А.О. Макаров. &#8212; Минск, 2006. &#8212; 156 с.<br>
    <li>Wang Z., Bovik A.C., Sheikh H.R. Image quality assessment: From error visibility to structural similarity //
        IEEE transaction on Image Processing. &#8212; 2004. &#8212; Vol. 13, № 4. &#8212; P. 309-12.
</ol>
    </p>
</div>
</body>
</html>